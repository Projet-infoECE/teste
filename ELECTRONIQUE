
#include<Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
int sensorPin=A0;
int reading = 0;
float voltage = 0;
int button = A2;
int btnh = A3;
int i = 0;
int h = 0;

unsigned long lastUpdateTime = 0;
unsigned long updateInterval = 100; // Mettez à jour toutes les 100 millisecondes (ou la valeur souhaitée)


Adafruit_SSD1306 display(SCREEN_WIDTH,SCREEN_HEIGHT,&Wire,-1);

void setup(){
pinMode(sensorPin, INPUT);
pinMode(button,INPUT);
pinMode(button,INPUT);
Serial.begin(9600);

if (!display.begin(SSD1306_SWITCHCAPVCC,0x3C)){
Serial.println(F("SSD1306 allocation failed"));
for( ;; );
}
}


void loop() {
unsigned long currentMillis = millis();

// Mettez à jour l'affichage à intervalles réguliers
if (currentMillis - lastUpdateTime >= updateInterval) {
 lastUpdateTime = currentMillis;

 display.clearDisplay();
 display.setTextSize(1);
 display.setTextColor(WHITE);
 display.setCursor(0,10);
 reading = analogRead(sensorPin);
 voltage = reading *5.0/1023.0;
 display.print("Menu\n parametrage heure");


 if (reading>=100 && reading <150){
           display.clearDisplay();
      display.setTextSize(1);
      display.setTextColor(WHITE);
      display.setCursor(0,10);
      display.print("Reglage du reveil");
      display.setCursor(0,30);
      display.print(h);
      display.print(" H ");
      display.print(i);
      display.display();

 if (digitalRead(button)==HIGH){
      i++;
          if (i == 60){
              i=0;
              h = h+1;
              if (h==24){
              i=0;
              h=0;
            }
          }

      display.clearDisplay();
      display.setTextSize(1);
      display.setTextColor(WHITE);
      display.setCursor(0,10);
      display.print("Reglage du reveil");
      display.setCursor(0,30);
      display.print(h);
      display.print(" H ");
      display.print(i);
      display.display();
      delay (100);
 }

  else if (digitalRead(btnh)==HIGH){
     h++;
              if (h==24){
              h=0;}

      display.clearDisplay();
      display.setTextSize(1);
      display.setTextColor(WHITE);
      display.setCursor(0,10);
      display.print("Reglage du reveil");
      display.setCursor(0,30);
      display.print(h);
      display.print(" H ");
      display.print(i);
      display.display();
 }

 }
 
 if (reading>=150){

     
      display.clearDisplay();
      display.setTextSize(1);
      display.setTextColor(WHITE);
      display.setCursor(0,10);
      display.print("Reglage du reveil");
      display.setCursor(0,20);
      display.print("Choisir un mode :");
      display.setCursor(0,30);
      display.print("Mode 24H");
      display.setCursor(0,40);
      display.print("Mode 12 AM/PM");
      display.display();
     
      if (digitalRead(button)==HIGH){

      }
 

 }
 
 
 else {
      delay(100);
 }

 display.display();
}
}
